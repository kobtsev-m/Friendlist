version: 1
backend:
  preBuild:
    commands:
      - cd amplify/backend/function/friendlist/src
      - yarn install
      - yarn migration:run
      - cd ../../../../../
  build:
    commands:
      - amplifyPush --simple
      - npm prune --production
      - npm install -g node-prune
      - node-prune
      - yarn build
frontend:
  phases:
    preBuild:
      commands:
        - yarn install
    build:
      commands:
        - yarn build
  artifacts:
    baseDirectory: build
    files:
      - '**/*'
  cache:
    paths:
      - node_modules/**/*
